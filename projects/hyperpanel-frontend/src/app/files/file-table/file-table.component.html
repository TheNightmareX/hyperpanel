<div class="container">
  <app-file-table-navigation
    class="table-navigation"
  ></app-file-table-navigation>

  <nz-table
    class="table-content"
    [nzData]="items"
    [nzFrontPagination]="false"
    [nzShowPagination]="false"
    [nzLoading]="loading"
    [nzLoadingDelay]="100"
    #table
  >
    <thead>
      <tr>
        <th
          [nzChecked]="!!getAllItemsCheckedStatus()"
          [nzIndeterminate]="getAllItemsCheckedStatus() == null"
          (nzCheckedChange)="setAllItemsCheckedStatus($event)"
        ></th>
        <th [nzSortFn]="sorters[0]" nzSortOrder="ascend">Name</th>
        <th [nzSortFn]="sorters[1]">Modified At</th>
        <th [nzSortFn]="sorters[2]">Type</th>
        <th [nzSortFn]="sorters[3]">Size</th>
      </tr>
    </thead>
    <tbody>
      <tr
        *ngFor="let entry of table.data.entries(); trackBy: tracker"
        (click)="handleItemClick(entry[1], $event)"
        (dblclick)="openItem(entry[1])"
        (contextmenu)="openMenu(entry[1], $event, menu)"
      >
        <td
          [nzChecked]="getItemCheckedStatus(entry[1])"
          (nzCheckedChange)="setItemCheckedStatus(entry[1], $event)"
        ></td>
        <td>
          <i nz-icon [nzType]="entry[1].icon"></i>
          <span>{{ entry[1].name }}</span>
        </td>
        <td>{{ entry[1].modifiedAt | date: 'yyyy/MM/dd HH:mm:ss' }}</td>
        <td>{{ entry[1].typeFinalized }}</td>
        <td>{{ entry[1].sizeFinalized }}</td>
      </tr>
    </tbody>
  </nz-table>

  <div class="table-footer">
    <div class="table-info">
      <span>{{ total }} items</span>
      <nz-divider nzType="vertical"></nz-divider>
      <span>{{ itemsChecked.size }} selected</span>
    </div>

    <nz-pagination
      nzResponsive
      nzShowSizeChanger
      [nzPageSizeOptions]="[50, 100, 200, 500, 1000, 2000]"
      nzShowQuickJumper
      [(nzPageIndex)]="page"
      [(nzPageSize)]="size"
      [nzTotal]="total"
      (nzPageIndexChange)="query()"
      (nzPageSizeChange)="page = 1; query()"
      [nzDisabled]="loading"
    ></nz-pagination>
  </div>
</div>

<app-file-table-menu [targets]="itemsChecked" #menu></app-file-table-menu>
